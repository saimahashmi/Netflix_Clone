<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StreamFlix - Watch Unlimited Movies & TV Shows</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-bg: #141414;
            --secondary-bg: #000000;
            --accent-red: #E50914;
            --text-primary: #FFFFFF;
            --text-secondary: #808080;
            --modal-bg: #181818;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
        }

        body {
            background-color: var(--primary-bg);
            color: var(--text-primary);
            overflow-x: hidden;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--primary-bg);
        }

        ::-webkit-scrollbar-thumb {
            background: #333;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* Navbar */
        .navbar {
            position: fixed;
            top: 0;
            width: 100%;
            height: 70px;
            padding: 0 4%;
            display: flex;
            align-items: center;
            justify-content: space-between;
            z-index: 1000;
            background: linear-gradient(to bottom, rgba(0, 0, 0, 0.7) 10%, transparent);
            transition: background-color 0.4s;
        }

        .navbar.scrolled {
            background-color: var(--primary-bg);
        }

        .nav-left {
            display: flex;
            align-items: center;
            gap: 25px;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            color: var(--accent-red);
            text-decoration: none;
            letter-spacing: 1px;
        }

        .nav-links {
            display: flex;
            gap: 20px;
            list-style: none;
        }

        .nav-links a {
            color: #e5e5e5;
            text-decoration: none;
            font-size: 14px;
            transition: color 0.3s;
        }

        .nav-links a:hover,
        .nav-links a.active {
            color: var(--text-primary);
            font-weight: 500;
        }

        .nav-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .icon-btn {
            color: white;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 18px;
        }

        /* Search */
        .search-box {
            display: flex;
            align-items: center;
            background: #000;
            border: 1px solid #fff;
            padding: 5px 10px;
            opacity: 0;
            width: 0;
            transition: var(--transition);
            overflow: hidden;
            visibility: hidden;
        }

        .search-box.active {
            opacity: 1;
            width: 250px;
            visibility: visible;
        }

        .search-input {
            background: transparent;
            border: none;
            color: white;
            outline: none;
            margin-left: 10px;
            width: 100%;
        }

        .search-results {
            position: absolute;
            top: 70px;
            right: 100px;
            background: #2f2f2f;
            width: 300px;
            max-height: 400px;
            overflow-y: auto;
            display: none;
        }

        .search-results.active {
            display: block;
        }

        .search-result-item {
            display: flex;
            gap: 10px;
            padding: 10px;
            border-bottom: 1px solid #404040;
            cursor: pointer;
        }

        .search-result-item:hover {
            background: #404040;
        }

        .search-result-img {
            width: 50px;
            height: 75px;
            object-fit: cover;
        }

        /* Dropdown */
        .profile-menu {
            position: relative;
        }

        .profile-dropdown {
            position: absolute;
            top: 40px;
            right: 0;
            background: rgba(0, 0, 0, 0.9);
            border: 1px solid #333;
            width: 200px;
            display: none;
            flex-direction: column;
            padding: 10px 0;
        }

        .profile-dropdown.show {
            display: flex;
        }

        .profile-dropdown a {
            color: #fff;
            text-decoration: none;
            padding: 10px 20px;
            font-size: 13px;
        }

        .profile-dropdown a:hover {
            text-decoration: underline;
        }

        /* Hero */
        .hero {
            height: 100vh;
            width: 100%;
            position: relative;
            background-size: cover;
            background-position: center;
            display: flex;
            align-items: center;
        }

        .hero::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to top, var(--primary-bg) 0%, transparent 60%);
        }

        .hero-content {
            position: relative;
            z-index: 10;
            padding-left: 4%;
            max-width: 600px;
            padding-top: 100px;
        }

        .hero-title {
            font-size: 60px;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .hero-desc {
            font-size: 1.2rem;
            line-height: 1.5;
            margin-bottom: 20px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }

        .hero-btns {
            display: flex;
            gap: 10px;
        }

        .btn {
            border: none;
            padding: 12px 30px;
            border-radius: 4px;
            font-size: 1.1rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: var(--transition);
        }

        .btn-play {
            background: white;
            color: black;
        }

        .btn-play:hover {
            background: rgba(255, 255, 255, 0.75);
        }

        .btn-info {
            background: rgba(109, 109, 110, 0.7);
            color: white;
        }

        .btn-info:hover {
            background: rgba(109, 109, 110, 0.4);
        }

        /* Rows */
        .row {
            margin: 30px 0;
            padding-left: 4%;
            position: relative;
        }

        .row-title {
            font-size: 1.4rem;
            font-weight: 500;
            margin-bottom: 10px;
            color: #e5e5e5;
        }

        .row-container {
            position: relative;
        }

        .row-posters {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding: 20px 0 20px 0;
            scroll-behavior: smooth;
        }

        .row-posters::-webkit-scrollbar {
            display: none;
        }

        .card {
            flex: 0 0 auto;
            width: 200px;
            /* Base width */
            height: 300px;
            position: relative;
            border-radius: 4px;
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 4px;
        }

        /* Top 10 Row Styling */
        .row-top10 .card {
            width: 240px;
            /* Wider for numbers */
            display: flex;
            align-items: center;
            background: transparent;
        }

        .rank-number {
            font-size: 10rem;
            font-weight: bold;
            color: black;
            -webkit-text-stroke: 4px #595959;
            text-shadow: 0 0 10px rgba(0, 0, 0, 0.8);
            position: relative;
            right: -20px;
            z-index: 0;
            line-height: 1;
        }

        .row-top10 .card img {
            z-index: 1;
            width: 140px;
            height: 200px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(229, 9, 20, 0.7);
            }

            70% {
                box-shadow: 0 0 0 10px rgba(229, 9, 20, 0);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(229, 9, 20, 0);
            }
        }

        .card:hover {
            transform: scale(1.3);
            z-index: 100;
            animation: pulse 2s infinite 2s;
        }

        .row-top10 .card:hover {
            transform: scale(1.1);
        }

        .card-info {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: #181818;
            padding: 10px;
            opacity: 0;
            transition: 0.3s;
            border-radius: 0 0 4px 4px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.5);
            font-size: 10px;
            pointer-events: none;
            /* Let clicks pass through */
        }

        .card:hover .card-info {
            /* We only show this if it was implemented as a dropdown. 
               For this implementation, we can just overlay buttons on the image or use a separate overlay.
               Let's update to match requirements more closely with an overlay div. */
            opacity: 1;
            pointer-events: auto;
        }

        .card-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 5px;
        }

        .card-btn {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            border: 1px solid rgba(255, 255, 255, 0.5);
            background: #2a2a2a;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .card-btn.match-high {
            color: #46d369;
        }

        .card-match {
            color: #46d369;
            font-weight: bold;
            margin-right: 5px;
        }

        /* Navigation Arrows */
        .slider-arrow {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 50px;
            background: rgba(0, 0, 0, 0.5);
            z-index: 50;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.2s;
            border: none;
        }

        .slider-arrow:hover {
            background: rgba(0, 0, 0, 0.7);
        }

        .row:hover .slider-arrow {
            opacity: 1;
        }

        .arrow-left {
            left: 0;
        }

        .arrow-right {
            right: 0;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            display: none;
            justify-content: center;
            align-items: center;
            overflow-y: auto;
            padding-top: 50px;
            /* Spacer for top */
            animation: fadeIn 0.3s;
        }

        .modal {
            background: #181818;
            width: 90%;
            max-width: 850px;
            border-radius: 8px;
            position: relative;
            overflow: hidden;
            margin-bottom: 50px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.7);
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 36px;
            height: 36px;
            background: #181818;
            border-radius: 50%;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 20;
            border: none;
            font-size: 20px;
        }

        .modal-hero {
            height: 480px;
            position: relative;
            background-size: cover;
            background-position: center;
        }

        .modal-hero::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 150px;
            background: linear-gradient(to top, #181818, transparent);
        }

        .modal-content-container {
            padding: 0 40px 40px 40px;
            margin-top: -50px;
            /* Pull text up */
            position: relative;
            z-index: 10;
        }

        .modal-title {
            font-size: 40px;
            margin-bottom: 10px;
        }

        .modal-meta {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 15px 0;
            color: #d2d2d2;
        }

        .match-score {
            color: #46d369;
            font-weight: bold;
        }

        .modal-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .modal-desc {
            font-size: 16px;
            line-height: 1.5;
            color: white;
        }

        .modal-tags {
            font-size: 14px;
            line-height: 1.6;
        }

        .modal-tags span {
            color: #777;
        }

        /* My List Page */
        .mylist-container {
            padding: 100px 4% 40px;
            min-height: 100vh;
            display: none;
            /* Hidden by default */
        }

        .mylist-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        /* Footer */
        footer {
            max-width: 980px;
            margin: 20px auto 0;
            padding: 30px 4%;
            color: #737373;
            font-size: 13px;
        }

        .footer-social {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            font-size: 24px;
            color: white;
        }

        .footer-links {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .footer-links a {
            color: #737373;
            text-decoration: none;
        }

        .footer-links a:hover {
            text-decoration: underline;
        }

        .service-code {
            border: 1px solid #737373;
            padding: 5px;
            display: inline-block;
            margin: 20px 0;
            font-size: 12px;
        }

        /* Notifications */
        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            color: black;
            padding: 10px 20px;
            border-radius: 4px;
            font-weight: bold;
            z-index: 3000;
            display: none;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .toast.show {
            display: block;
            opacity: 1;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .hero-title {
                font-size: 40px;
            }

            .card {
                width: 180px;
                height: 270px;
            }

            .modal-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }

            /* Hamburger should be here but simplifying for now or add JS toggle */
            .hamburger {
                display: block;
                color: white;
                font-size: 24px;
                cursor: pointer;
                margin-right: 15px;
            }

            .hero-title {
                font-size: 30px;
            }

            .hero-desc {
                font-size: 14px;
                max-width: 100%;
            }

            .footer-links {
                grid-template-columns: 1fr 1fr;
            }

            .card {
                width: 140px;
                height: 210px;
            }
        }

        /* Mobile Menu Overlay (Simple) */
        .mobile-menu {
            position: fixed;
            top: 70px;
            left: 0;
            width: 100%;
            background: #141414;
            border-top: 1px solid #333;
            display: none;
            flex-direction: column;
            padding: 20px;
            z-index: 999;
        }

        .mobile-menu.active {
            display: flex;
        }

        .mobile-menu a {
            color: white;
            text-decoration: none;
            padding: 15px 0;
            border-bottom: 1px solid #333;
            font-size: 16px;
        }
    </style>
</head>

<body>

    <!-- Header -->
    <header class="navbar" id="navbar">
        <div class="nav-left">
            <div class="hamburger" id="hamburger" onclick="toggleMobileMenu()"><i class="fas fa-bars"></i></div>
            <a href="#" class="logo" onclick="showHome()">STREAMFLIX</a>
            <ul class="nav-links">
                <li><a href="#" class="active" onclick="showHome()">Home</a></li>
                <li><a href="#" onclick="showHome()">TV Shows</a></li>
                <li><a href="#" onclick="showHome()">Movies</a></li>
                <li><a href="#" onclick="showHome()">New & Popular</a></li>
                <li><a href="#" onclick="showMyList()">My List <span id="list-count-badge"
                            style="background:#E50914; font-size:10px; padding:2px 5px; border-radius:3px; display:none;">0</span></a>
                </li>
            </ul>
        </div>
        <div class="nav-right">
            <div class="search-container" style="position: relative;">
                <button class="icon-btn" onclick="toggleSearch()"><i class="fas fa-search"></i></button>
                <div class="search-box" id="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" class="search-input" id="search-input" placeholder="Titles, people, genres">
                </div>
                <div class="search-results" id="search-results"></div>
            </div>
            <button class="icon-btn" style="position:relative;">
                <i class="fas fa-bell"></i>
                <span
                    style="position:absolute; top:0; right:0; width:8px; height:8px; background:red; border-radius:50%;"></span>
            </button>
            <div class="profile-menu">
                <button class="icon-btn" onclick="toggleProfile()"><img src="https://picsum.photos/seed/user/30/30"
                        style="border-radius:4px;" alt="Profile"></button>
                <div class="profile-dropdown" id="profile-dropdown">
                    <a href="#">Manage Profiles</a>
                    <a href="#">Account</a>
                    <a href="#">Help Center</a>
                    <a href="#">Sign Out</a>
                </div>
            </div>
        </div>
    </header>

    <div class="mobile-menu" id="mobile-menu">
        <a href="#" onclick="showHome()">Home</a>
        <a href="#" onclick="showHome()">TV Shows</a>
        <a href="#" onclick="showHome()">Movies</a>
        <a href="#" onclick="showMyList()">My List</a>
    </div>

    <!-- Main Content -->
    <main id="main-content">
        <!-- Hero Section -->
        <div class="hero" id="hero-section">
            <div class="hero-content">
                <h1 class="hero-title" id="hero-title">Loading...</h1>
                <p class="hero-desc" id="hero-desc">Loading description...</p>
                <div class="hero-btns">
                    <button class="btn btn-play" onclick="playHeroMsg()"><i class="fas fa-play"></i> Play</button>
                    <button class="btn btn-info" onclick="openHeroModal()"><i class="fas fa-info-circle"></i> More
                        Info</button>
                </div>
            </div>
        </div>

        <!-- Movie Rows Container -->
        <div id="wrapper" style="padding-bottom: 50px;">
            <!-- Rows injected by JS -->
        </div>
    </main>

    <!-- My List Page -->
    <div class="mylist-container" id="mylist-view">
        <h1 style="margin-bottom: 20px;">My List</h1>
        <div class="mylist-grid" id="mylist-grid">
            <p>You haven't added anything to your list yet.</p>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal-overlay" id="movie-modal">
        <div class="modal" id="modal-content">
            <button class="modal-close" onclick="closeModal()">×</button>
            <div class="modal-hero" id="modal-hero-img"></div>
            <div class="modal-content-container">
                <h2 class="modal-title" id="modal-title">Title</h2>
                <div class="modal-meta">
                    <span class="match-score" id="modal-match">98% Match</span>
                    <span id="modal-year">2023</span>
                    <span id="modal-rating" style="border:1px solid #777; padding:0 5px;">TV-MA</span>
                    <span id="modal-duration">2h 15m</span>
                    <span style="border:1px solid #777; padding:0 5px; font-size:10px; border-radius:3px;">HD</span>
                </div>
                <div class="modal-grid">
                    <div>
                        <div style="display:flex; gap:10px; margin-bottom:20px;">
                            <button class="btn btn-play" style="padding: 8px 25px;"><i class="fas fa-play"></i>
                                Play</button>
                            <button class="card-btn" id="modal-list-btn" onclick="toggleMyListFromModal()"><i
                                    class="fas fa-plus"></i></button>
                            <button class="card-btn"><i class="far fa-thumbs-up"></i></button>
                            <button class="card-btn"><i class="far fa-thumbs-down"></i></button>
                        </div>
                        <p class="modal-desc" id="modal-desc">Description goes here...</p>
                    </div>
                    <div class="modal-tags">
                        <div style="margin-bottom:10px;"><span style="color:#777">Cast:</span> <span id="modal-cast"
                                style="color:white;">Name, Name</span></div>
                        <div><span style="color:#777">Genres:</span> <span id="modal-genres" style="color:white;">Genre,
                                Genre</span></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast">Notification</div>

    <!-- Footer -->
    <footer>
        <div class="footer-social">
            <i class="fab fa-facebook-f"></i>
            <i class="fab fa-instagram"></i>
            <i class="fab fa-twitter"></i>
            <i class="fab fa-youtube"></i>
        </div>
        <div class="footer-links">
            <a href="#">Audio and Subtitles</a>
            <a href="#">Media Center</a>
            <a href="#">Privacy</a>
            <a href="#">Contact Us</a>
            <a href="#">Help Center</a>
            <a href="#">Jobs</a>
            <a href="#">Cookie Preferences</a>
            <a href="#">Legal Notices</a>
            <a href="#">Gift Cards</a>
            <a href="#">Terms of Use</a>
            <a href="#">Corporate Information</a>
        </div>
        <div class="service-code">Service Code</div>
        <div style="font-size: 11px;">&copy; 2026 StreamFlix Pakistan</div>
    </footer>

    <script>
        // --- 1. Data ---
        const genresList = ["Action", "Drama", "Comedy", "Sci-Fi", "Crime", "Documentary", "Thriller", "Horror"];
        const generateMovies = (count) => {
            const arr = [];
            for (let i = 1; i <= count; i++) {
                const seed = i + 100;
                arr.push({
                    id: i,
                    title: `Movie Title ${i}`,
                    description: `This is the exciting description for Movie ${i}. It is a very engaging story about heroes and villains clashing in an epic battle.`,
                    year: 2020 + Math.floor(Math.random() * 6),
                    rating: Math.random() > 0.5 ? "TV-MA" : "PG-13",
                    duration: `${1 + Math.floor(Math.random() * 2)}h ${10 + Math.floor(Math.random() * 50)}m`,
                    genres: [genresList[Math.floor(Math.random() * genresList.length)], genresList[Math.floor(Math.random() * genresList.length)]],
                    match: 70 + Math.floor(Math.random() * 30),
                    image: `https://picsum.photos/seed/${seed}/300/450`,
                    heroImage: `https://picsum.photos/seed/${seed}/900/500`, // Using slightly smaller hero for modal to save bandwidth, or logic for main hero
                    cast: ["Actor One", "Actor Two", "Actor Three"],
                    category: "Trending"
                });
            }
            return arr;
        };

        const allMovies = generateMovies(60);
        // Manual override for Hero
        const heroMovie = allMovies[0];
        heroMovie.title = "The Dark Knight";
        heroMovie.heroImage = "https://picsum.photos/seed/hero123/1920/1080";
        heroMovie.description = "When the menace known as the Joker wreaks havoc and chaos on the people of Gotham, Batman must accept one of the greatest psychological and physical tests of his ability to fight injustice.";

        let myList = [];
        let currentModalMovieId = null;

        // --- 2. State & Elements ---
        const navbar = document.getElementById('navbar');
        const searchBox = document.getElementById('search-box');
        const searchInput = document.getElementById('search-input');
        const searchResults = document.getElementById('search-results');
        const modal = document.getElementById('movie-modal');
        const myListView = document.getElementById('mylist-view');
        const mainContent = document.getElementById('main-content');

        // --- 3. Initialization ---
        function init() {
            renderHero();
            renderRow("Trending Now", allMovies.slice(0, 10));
            renderTop10Row("Top 10 in Pakistan Today", allMovies.slice(10, 20));
            renderRow("Netflix Originals", allMovies.slice(20, 30));
            renderRow("Action Movies", allMovies.filter(m => m.genres.includes("Action")));
            renderRow("Comedies", allMovies.filter(m => m.genres.includes("Comedy")));
            renderRow("Drama Series", allMovies.filter(m => m.genres.includes("Drama")));
            renderRow("Because You Watched The Dark Knight", allMovies.slice(30, 45));

            // Mobile Menu responsive check
            window.addEventListener('resize', () => {
                if (window.innerWidth > 768) {
                    document.getElementById('mobile-menu').classList.remove('active');
                    document.querySelector('.nav-links').style.display = 'flex';
                } else {
                    document.querySelector('.nav-links').style.display = 'none';
                }
            });
        }

        // --- 4. Render Functions ---
        function renderHero() {
            const hero = document.getElementById('hero-section');
            hero.style.backgroundImage = `url('${heroMovie.heroImage}')`;
            document.getElementById('hero-title').innerText = heroMovie.title;
            document.getElementById('hero-desc').innerText = heroMovie.description;
        }

        function renderRow(title, movies) {
            const wrapper = document.getElementById('wrapper');
            const rowDiv = document.createElement('div');
            rowDiv.className = 'row';

            let cardsHtml = movies.map(movie => createCardHtml(movie)).join('');

            rowDiv.innerHTML = `
                <h2 class="row-title">${title}</h2>
                <div class="row-container">
                    <button class="slider-arrow arrow-left" onclick="scrollRow(this, -1)">‹</button>
                    <div class="row-posters" id="row-${title.replace(/\s/g, '')}">
                        ${cardsHtml}
                    </div>
                    <button class="slider-arrow arrow-right" onclick="scrollRow(this, 1)">›</button>
                </div>
            `;
            wrapper.appendChild(rowDiv);
        }

        function renderTop10Row(title, movies) {
            const wrapper = document.getElementById('wrapper');
            const rowDiv = document.createElement('div');
            rowDiv.className = 'row row-top10';

            let cardsHtml = movies.map((movie, index) => {
                return `
                <div class="card" onclick="openModal(${movie.id})">
                    <span class="rank-number">${index + 1}</span>
                    <img src="${movie.image}" alt="${movie.title}" loading="lazy">
                    <div class="card-info">
                        <div class="card-buttons">
                            <button class="card-btn" onclick="event.stopPropagation(); playMovie(${movie.id})"><i class="fas fa-play"></i></button>
                            <button class="card-btn" onclick="event.stopPropagation(); toggleList(${movie.id})"><i class="fas ${myList.includes(movie.id) ? 'fa-check' : 'fa-plus'}"></i></button>
                            <button class="card-btn"><i class="far fa-thumbs-up"></i></button>
                            <button class="card-btn" onclick="event.stopPropagation(); openModal(${movie.id})"><i class="fas fa-chevron-down"></i></button>
                        </div>
                        <h4>${movie.title}</h4>
                        <div style="margin-top:5px; display:flex; gap:10px; align-items:center;">
                            <span class="match-score">${movie.match}% Match</span>
                            <span style="border:1px solid #777; padding:0 3px;">${movie.rating}</span>
                        </div>
                        <div style="margin-top:5px; color:#777;">${movie.genres.join(' • ')}</div>
                    </div>
                </div>
                `;
            }).join('');

            rowDiv.innerHTML = `
                <h2 class="row-title">${title}</h2>
                <div class="row-container">
                    <button class="slider-arrow arrow-left" onclick="scrollRow(this, -1)">‹</button>
                    <div class="row-posters" id="row-top10">
                        ${cardsHtml}
                    </div>
                    <button class="slider-arrow arrow-right" onclick="scrollRow(this, 1)">›</button>
                </div>
            `;
            wrapper.appendChild(rowDiv);
        }

        function createCardHtml(movie) {
            return `
            <div class="card" onclick="openModal(${movie.id})">
                <img src="${movie.image}" alt="${movie.title}" loading="lazy">
                <div class="card-info">
                    <div class="card-buttons">
                        <button class="card-btn" style="background:white; color:black;" onclick="event.stopPropagation(); playMovie(${movie.id})"><i class="fas fa-play"></i></button>
                        <button class="card-btn" id="btn-add-${movie.id}" onclick="event.stopPropagation(); toggleList(${movie.id})"><i class="fas ${myList.includes(movie.id) ? 'fa-check' : 'fa-plus'}"></i></button>
                        <button class="card-btn"><i class="far fa-thumbs-up"></i></button>
                        <button class="card-btn" onclick="event.stopPropagation(); openModal(${movie.id})"><i class="fas fa-chevron-down"></i></button>
                    </div>
                    <h4>${movie.title}</h4>
                    <div style="margin-top:5px; display:flex; gap:10px; align-items:center;">
                        <span class="match-score">${movie.match}% Match</span>
                        <span style="border:1px solid #777; padding:0 3px;">${movie.rating}</span>
                        <span>${movie.duration}</span>
                    </div>
                    <div style="margin-top:5px; color:#777;">${movie.genres.join(' • ')}</div>
                </div>
            </div>
            `;
        }

        // --- 5. Interactivity ---

        // Scroll Logic
        window.addEventListener('scroll', () => {
            if (window.scrollY > 50) {
                navbar.classList.add('scrolled');
            } else {
                navbar.classList.remove('scrolled');
            }
        });

        function scrollRow(btn, direction) {
            const container = btn.parentElement.querySelector('.row-posters');
            const scrollAmount = window.innerWidth * 0.8;
            container.scrollBy({ left: direction * scrollAmount, behavior: 'smooth' });
        }

        // Search Logic
        function toggleSearch() {
            if (searchBox.classList.contains('active')) {
                searchBox.classList.remove('active');
                searchResults.classList.remove('active');
            } else {
                searchBox.classList.add('active');
                searchInput.focus();
            }
        }

        let debounceTimer;
        searchInput.addEventListener('input', (e) => {
            clearTimeout(debounceTimer);
            debounceTimer = setTimeout(() => {
                const query = e.target.value.toLowerCase();
                if (query.length > 1) {
                    const matches = allMovies.filter(m => m.title.toLowerCase().includes(query) || m.genres.some(g => g.toLowerCase().includes(query)));
                    renderSearchResults(matches);
                } else {
                    searchResults.classList.remove('active');
                }
            }, 300);
        });

        function renderSearchResults(movies) {
            if (movies.length === 0) {
                searchResults.innerHTML = '<div style="padding:10px; color:#777;">No results found.</div>';
            } else {
                searchResults.innerHTML = movies.map(m => `
                    <div class="search-result-item" onclick="openModal(${m.id})">
                        <img src="${m.image}" class="search-result-img">
                        <div>
                            <div style="color:white; font-weight:bold;">${m.title}</div>
                            <div style="font-size:12px; color:#aaa;">${m.year}</div>
                        </div>
                    </div>
                `).join('');
            }
            searchResults.classList.add('active');
        }

        // Modal Logic
        function openModal(id) {
            const movie = allMovies.find(m => m.id === id);
            if (!movie) return;
            currentModalMovieId = id;

            document.getElementById('modal-hero-img').style.backgroundImage = `url('${movie.heroImage}')`;
            document.getElementById('modal-title').innerText = movie.title;
            document.getElementById('modal-desc').innerText = movie.description;
            document.getElementById('modal-match').innerText = `${movie.match}% Match`;
            document.getElementById('modal-year').innerText = movie.year;
            document.getElementById('modal-rating').innerText = movie.rating;
            document.getElementById('modal-duration').innerText = movie.duration;
            document.getElementById('modal-cast').innerText = movie.cast.join(', ');
            document.getElementById('modal-genres').innerText = movie.genres.join(', ');

            const listBtn = document.getElementById('modal-list-btn');
            listBtn.innerHTML = myList.includes(id) ? '<i class="fas fa-check"></i>' : '<i class="fas fa-plus"></i>';

            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden'; // Stop background scroll
        }

        function openHeroModal() {
            openModal(heroMovie.id);
        }

        function closeModal() {
            modal.style.display = 'none';
            document.body.style.overflow = 'auto'; // Restore scroll
        }

        window.onclick = function (event) {
            if (event.target == modal) {
                closeModal();
            }
            if (!event.target.closest('.search-container')) {
                searchResults.classList.remove('active');
                if (searchInput.value === '') searchBox.classList.remove('active');
            }
            if (!event.target.closest('.profile-menu')) {
                document.getElementById('profile-dropdown').classList.remove('show');
            }
        }

        // My List Logic
        function toggleList(id) {
            if (myList.includes(id)) {
                myList = myList.filter(mId => mId !== id);
                showToast("Removed from My List");
            } else {
                myList.push(id);
                showToast("Added to My List");
            }
            updateUI();
        }

        function toggleMyListFromModal() {
            if (currentModalMovieId) {
                toggleList(currentModalMovieId);
                const listBtn = document.getElementById('modal-list-btn');
                listBtn.innerHTML = myList.includes(currentModalMovieId) ? '<i class="fas fa-check"></i>' : '<i class="fas fa-plus"></i>';
            }
        }

        function updateUI() {
            // Update counts or icons in rows
            allMovies.forEach(m => {
                const btn = document.getElementById(`btn-add-${m.id}`);
                if (btn) {
                    btn.innerHTML = myList.includes(m.id) ? '<i class="fas fa-check"></i>' : '<i class="fas fa-plus"></i>';
                }
            });

            const badge = document.getElementById('list-count-badge');
            if (myList.length > 0) {
                badge.style.display = 'inline-block';
                badge.innerText = myList.length;
            } else {
                badge.style.display = 'none';
            }

            renderMyList();
        }

        function showMyList() {
            renderMyList();
            myListView.style.display = 'block';
            mainContent.style.display = 'none';
            window.scrollTo(0, 0);
        }

        function showHome() {
            myListView.style.display = 'none';
            mainContent.style.display = 'block';
            window.scrollTo(0, 0);
        }

        function renderMyList() {
            const grid = document.getElementById('mylist-grid');
            if (myList.length === 0) {
                grid.innerHTML = '<p style="color:#777;">You haven\'t added anything to your list yet.</p>';
                return;
            }

            grid.innerHTML = myList.map(id => {
                const movie = allMovies.find(m => m.id === id);
                if (!movie) return '';
                return `
                <div class="card" onclick="openModal(${movie.id})">
                    <img src="${movie.image}" alt="${movie.title}" loading="lazy">
                    <div class="card-info">
                        <div class="card-buttons">
                            <button class="card-btn" onclick="event.stopPropagation(); playMovie(${movie.id})"><i class="fas fa-play"></i></button>
                            <button class="card-btn" onclick="event.stopPropagation(); toggleList(${movie.id})"><i class="fas fa-check"></i></button>
                            <button class="card-btn" onclick="event.stopPropagation(); openModal(${movie.id})"><i class="fas fa-chevron-down"></i></button>
                        </div>
                        <h4>${movie.title}</h4>
                    </div>
                </div>
                `;
            }).join('');
        }

        // Utils
        function showToast(msg) {
            const toast = document.getElementById('toast');
            toast.innerText = msg;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        function toggleProfile() {
            document.getElementById('profile-dropdown').classList.toggle('show');
        }

        function toggleMobileMenu() {
            document.getElementById('mobile-menu').classList.toggle('active');
        }

        function playMovie(id) {
            console.log("Playing movie", id);
            // Simulate playing
        }

        function playHeroMsg() {
            console.log("Playing hero movie");
        }

        // Run
        init();

    </script>
</body>

</html>